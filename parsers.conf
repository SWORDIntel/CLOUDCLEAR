# CloudUnflare Enhanced v2.0 - Fluent Bit Parsers Configuration
# Custom parsers for CloudUnflare log formats

[PARSER]
    Name        cloudunflare_parser
    Format      regex
    Regex       ^\[(?<timestamp>[^\]]+)\] \[(?<level>[^\]]+)\] \[(?<component>[^\]]+)\] (?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        cloudunflare_recon_parser
    Format      regex
    Regex       ^\[(?<timestamp>[^\]]+)\] \[(?<level>[^\]]+)\] \[RECON:(?<module>[^\]]+)\] (?<target>\S+) - (?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        cloudunflare_security_parser
    Format      regex
    Regex       ^\[(?<timestamp>[^\]]+)\] \[SECURITY\] \[(?<event_type>[^\]]+)\] Score:(?<threat_score>\d+\.\d+) (?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        dns_query_parser
    Format      regex
    Regex       ^\[(?<timestamp>[^\]]+)\] DNS (?<query_type>\w+) (?<domain>\S+) -> (?<resolver>\S+) \[(?<response_time>\d+)ms\] (?<status>\w+)(?<details>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        cloudunflare_main_detailed
    Format      regex
    Regex       ^(?<operation>\w+): (?<target>\S+) \[Threads:(?<threads>\d+)\] \[QPS:(?<qps>\d+)\] (?<result>.*)$

[PARSER]
    Name        recon_detailed
    Format      regex
    Regex       ^(?<scan_type>\w+) scan of (?<target>\S+): Found (?<results_count>\d+) results in (?<duration>\d+)ms$

[PARSER]
    Name        performance_metrics
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On

[PARSER]
    Name        json
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ